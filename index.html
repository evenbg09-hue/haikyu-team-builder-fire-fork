<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Time de Voleibol</title>
<style>
    body {
        background-color: #222;
        color: white;
        font-family: Arial, sans-serif;
        text-align: center;
    }
    .container {
        display: flex;
        flex-direction: column;
        align-items: center;
    }
    .row {
        display: flex;
        gap: 20px;
        margin: 20px 0;
    }
    .slot {
        width: 100px;
        height: 120px;
        background-color: #444;
        border: 2px dashed #888;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        position: relative;
    }
    .slot img {
        max-width: 100%;
        max-height: 80px;
    }
    .slot span {
        margin-top: 5px;
        font-size: 12px;
    }
    .bench-slot {
        width: 50px;
        height: 67px;
        background-color: #555;
        border: 2px dashed #888;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .scroll-menu {
        max-height: 150px;
        overflow-y: auto;
        background: #333;
        border: 1px solid #666;
        padding: 5px;
        position: absolute;
        top: 100%;
        z-index: 10;
    }
    .player-option {
        padding: 5px;
        cursor: pointer;
        background: #444;
        margin: 2px 0;
        display: flex;
        align-items: center;
        gap: 5px;
    }
    .player-option img {
        width: 30px;
        height: 30px;
    }
    .player-option:hover {
        background: #555;
    }
</style>
</head>
<body>

<h1>Montar Time</h1>
<div class="container">
    <!-- Linha de cima -->
    <div class="row top-row" style="transform: translateX(6px);">
        <div class="slot" data-pos="S">Setter</div>
        <div class="slot" data-pos="MB">Middle Blocker</div>
        <div class="slot" data-pos="WS">Wing Spiker</div>
    </div>

    <!-- Linha de baixo -->
    <div class="row bottom-row">
        <div class="slot" data-pos="L">Libero</div>
        <div class="slot" data-pos="WS">Wing Spiker</div>
        <div class="slot" data-pos="MB">Middle Blocker</div>
        <div class="slot" data-pos="OP">Opposite</div>
    </div>

    <!-- Banco -->
    <h3>Banco</h3>
    <div class="row bench-row" id="benchRow">
        <div class="slot bench-slot" data-pos="bench"></div>
        <div class="slot bench-slot" data-pos="bench"></div>
        <div class="slot bench-slot" data-pos="bench"></div>
    </div>
    <button id="addBenchSlot">Adicionar Slot</button>
</div>

<div id="synergy"></div>

<script>
const players = [
    { name: "Atsumu", pos: "S", school: "Inarizaki" },
    { name: "Kageyama", pos: "S", school: "Karasuno" },
    { name: "Bokuto", pos: "WS", school: "Fukurodani" },
    { name: "Hinata", pos: "WS", school: "Karasuno" },
    { name: "Kuroo", pos: "MB", school: "Nekoma" },
    { name: "Tsukishima", pos: "MB", school: "Karasuno" },
    { name: "Sakusa", pos: "OP", school: "Itachiyama" },
    { name: "Yaku", pos: "L", school: "Nekoma" }
];
let selected = {};

function createMenu(slot) {
    closeMenus();
    let menu = document.createElement("div");
    menu.classList.add("scroll-menu");

    let slotPos = slot.dataset.pos;
    let benchMode = slot.classList.contains("bench-slot");

    players.filter(p => !Object.values(selected).some(sel => sel && sel.name === p.name))
           .filter(p => benchMode || p.pos === slotPos)
           .forEach(p => {
               let div = document.createElement("div");
               div.classList.add("player-option");

               let img = document.createElement("img");
               img.src = `img/${p.name}.png`;

               let label = document.createElement("span");
               label.innerText = `${p.name} (${p.pos})`;

               div.appendChild(img);
               div.appendChild(label);

               div.onclick = () => {
                   if (benchMode && !checkBenchRules(p)) return alert("Limite para essa posição no banco atingido!");
                   setPlayer(slot, p);
                   closeMenus();
               };
               menu.appendChild(div);
           });

    slot.appendChild(menu);
}

function closeMenus() {
    document.querySelectorAll(".scroll-menu").forEach(m => m.remove());
}

function setPlayer(slot, player) {
    slot.innerHTML = `<img src="img/${player.name}.png"><span>${player.name} (${player.pos})</span>`;
    selected[slot.dataset.slotId] = player;
    checkSynergy();
}

function removePlayer(slot) {
    slot.innerHTML = slot.classList.contains("bench-slot") ? "" : slot.dataset.posName;
    delete selected[slot.dataset.slotId];
    checkSynergy();
}

function checkBenchRules(player) {
    let counts = { MB: 0, WS: 0, S: 0, L: 0, OP: 0 };
    document.querySelectorAll(".bench-slot").forEach(s => {
        let sel = selected[s.dataset.slotId];
        if (sel) counts[sel.pos]++;
    });
    if (player.pos === "MB" && counts.MB >= 2) return false;
    if (player.pos === "WS" && counts.WS >= 2) return false;
    if (["S", "L", "OP"].includes(player.pos) && counts[player.pos] >= 1) return false;
    return true;
}

function checkSynergy() {
    let mainSlots = document.querySelectorAll(".slot:not(.bench-slot)");
    let schoolCount = {};
    let mainPlayers = [];

    mainSlots.forEach(s => {
        let sel = selected[s.dataset.slotId];
        if (sel) {
            mainPlayers.push(sel.name);
            schoolCount[sel.school] = (schoolCount[sel.school] || 0) + 1;
        }
    });

    let synergies = [];

    for (let school in schoolCount) {
        if (schoolCount[school] >= 4) synergies.push(`Sinergia de Escola: ${school}`);
    }

    if (mainPlayers.includes("Atsumu") && mainPlayers.includes("Sakusa"))
        synergies.push("Sinergia de Vínculo: MSBY Duo");

    document.getElementById("synergy").innerText = synergies.join("\n");
}

document.querySelectorAll(".slot").forEach((slot, i) => {
    slot.dataset.slotId = i;
    if (!slot.classList.contains("bench-slot")) slot.dataset.posName = slot.innerText;
    slot.addEventListener("click", () => createMenu(slot));
    slot.addEventListener("contextmenu", e => {
        e.preventDefault();
        removePlayer(slot);
    });
});

document.getElementById("addBenchSlot").addEventListener("click", () => {
    let slot = document.createElement("div");
    slot.classList.add("slot", "bench-slot");
    slot.dataset.pos = "bench";
    slot.dataset.slotId = document.querySelectorAll(".slot").length;
    slot.addEventListener("click", () => createMenu(slot));
    slot.addEventListener("contextmenu", e => {
        e.preventDefault();
        removePlayer(slot);
    });
    document.getElementById("benchRow").appendChild(slot);
});

</script>
</body>
</html>


