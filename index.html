<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Haikyu Fly High - Team Builder</title>
<style>
    body {
        background-color: #222;
        color: #fff;
        font-family: Arial, sans-serif;
        text-align: center;
    }
    h1 { margin-top: 20px; }
    .team-grid { display: flex; flex-direction: column; gap: 20px; align-items: center; margin-top: 30px; }
    .row { display: flex; gap: 20px; }
    .top-row { transform: translateX(6px); }
    .player-slot { display: flex; flex-direction: column; align-items: center; }
    .hex {
        position: relative; width: 150px; height: 210px;
        background-color: #444; border-radius: 10px;
        display: flex; align-items: center; justify-content: center;
        cursor: pointer; transition: background 0.3s; overflow: hidden;
    }
    .hex:hover { background-color: #555; }
    .hex img { width: 100%; height: 100%; object-fit: cover; }
    .player-info { margin-top: 5px; font-size: 14px; color: #fff; text-align: center; }
    #synergy-panel {
        margin-top: 50px; background-color: #333; padding: 15px;
        border-radius: 10px; max-width: 600px; margin-left: auto; margin-right: auto; text-align: left;
    }
    .scroll-menu {
        display: none; margin-top: 10px; max-height: 200px; overflow-y: auto;
        background-color: #333; padding: 10px; border-radius: 8px;
    }
    .scroll-menu img {
        width: 80px; height: auto; cursor: grab; margin: 5px; border: 2px solid transparent;
    }
    .scroll-menu img:hover { border: 2px solid yellow; }
    #banco-container { margin-top: 30px; }
    #addBancoBtn {
        background-color: #28a745; color: white; border: none; padding: 10px 20px;
        font-size: 16px; border-radius: 5px; cursor: pointer;
    }
    #addBancoBtn:hover { background-color: #218838; }
</style>
</head>
<body>

<h1>Haikyu!! Fly High - Team Builder</h1>

<div class="team-grid">
    <div class="row top-row">
        <div class="player-slot"><div class="hex" data-role="S" data-pos="principal"></div><div class="player-info">S</div></div>
        <div class="player-slot"><div class="hex" data-role="MB" data-pos="principal"></div><div class="player-info">MB</div></div>
        <div class="player-slot"><div class="hex" data-role="WS" data-pos="principal"></div><div class="player-info">WS</div></div>
    </div>
    <div class="row">
        <div class="player-slot"><div class="hex" data-role="L" data-pos="principal"></div><div class="player-info">L</div></div>
        <div class="player-slot"><div class="hex" data-role="WS" data-pos="principal"></div><div class="player-info">WS</div></div>
        <div class="player-slot"><div class="hex" data-role="MB" data-pos="principal"></div><div class="player-info">MB</div></div>
        <div class="player-slot"><div class="hex" data-role="OP" data-pos="principal"></div><div class="player-info">OP</div></div>
    </div>
</div>

<div id="banco-container">
    <h2>Banco de Reservas</h2>
    <button id="addBancoBtn">Adicionar ao Banco</button>
    <div class="row" id="banco"></div>
</div>

<div class="scroll-menu" id="scrollMenu"></div>

<div id="synergy-panel">
    <h2>Sinergias Ativas</h2>
    <ul id="synergy-list">
        <li>Nenhuma sinergia ativa</li>
    </ul>
</div>

<script>
const personagens = [
    { nome: "Tobio Kageyama", funcao: "S", img: "img/kageyamaUR.png", escola: "Karasuno", vinculo: "Freak Quick" },
    { nome: "Kōshi Sugawara", funcao: "S", img: "img/sugawara.png", escola: "Karasuno", vinculo: "Suporte" },
    { nome: "Kenma Kozume", funcao: "S", img: "img/kenmaSP.png", escola: "Nekoma", vinculo: "Time Nekoma" },
    { nome: "Toru Oikawa", funcao: "S", img: "img/oikawaUR.png", escola: "Aoba Johsai", vinculo: "Parceria Iwaizumi" },
    { nome: "Shoyo Hinata", funcao: "MB", img: "img/hinataSP.png", escola: "Karasuno", vinculo: "Freak Quick" },
    { nome: "Tetsurō Kuroo", funcao: "MB", img: "img/kurooUR.png", escola: "Nekoma", vinculo: "Time Nekoma" },
    { nome: "Kei Tsukishima", funcao: "MB", img: "img/tsukiSP.png", escola: "Karasuno", vinculo: "Dupla Yamaguchi" },
    { nome: "Takanobu Aone", funcao: "MB", img: "img/aone.png", escola: "Date Tech", vinculo: "Paredão de Ferro" },
    { nome: "Wakatoshi Ushijima", funcao: "WS", img: "img/ushijima.png", escola: "Shiratorizawa", vinculo: "Capitão" },
    { nome: "Hajime Iwaizumi", funcao: "WS", img: "img/iwaizumiSR.png", escola: "Aoba Johsai", vinculo: "Parceria Oikawa" },
    { nome: "Ryūnosuke Tanaka", funcao: "WS", img: "img/tanaka.png", escola: "Karasuno", vinculo: "Dupla Nishinoya" },
    { nome: "Kentarō Kyōtani", funcao: "OP", img: "img/kyotani.png", escola: "Aoba Johsai", vinculo: "Time Aoba Johsai" },
    { nome: "Asahi Azumane", funcao: "WS", img: "img/asahi.png", escola: "Karasuno", vinculo: "Time Karasuno" },
    { nome: "Daichi Sawamura", funcao: "OP", img: "img/daichiSR.png", escola: "Karasuno", vinculo: "Capitão" },
    { nome: "Yū Nishinoya", funcao: "L", img: "img/nishinoyaSP.png", escola: "Karasuno", vinculo: "Dupla Tanaka" },
    { nome: "Tadashi Yamaguchi", funcao: "MB", img: "img/yamaguchi.png", escola: "Karasuno", vinculo: "Dupla Tsukishima" },
    { nome: "Issei Matsukawa", funcao: "MB", img: "img/matsukawa.png", escola: "Aoba Johsai", vinculo: "Time Aoba Johsai" }
];

const hexes = document.querySelectorAll('.hex');
const synergyList = document.getElementById('synergy-list');
const scrollMenu = document.getElementById('scrollMenu');
const bancoContainer = document.getElementById('banco');
const addBancoBtn = document.getElementById('addBancoBtn');

let selecionados = [];
let banco = [];

// Mostrar menu filtrando quem já foi escolhido
function mostrarMenu(role, hex, posicao) {
    scrollMenu.innerHTML = '';
    const disponiveis = personagens.filter(p => 
        p.funcao === role && !selecionados.includes(p)
    );
    disponiveis.forEach(p => {
        const img = document.createElement('img');
        img.src = p.img;
        img.alt = p.nome;
        img.draggable = true;
        img.title = p.nome;
        img.addEventListener('click', () => {
            if (posicao === "banco") setPersonagemNoBanco(hex, p);
            else setPersonagemNoHex(hex, p);
        });
        img.addEventListener('dragstart', e => {
            e.dataTransfer.setData('text', p.nome);
        });
        scrollMenu.appendChild(img);
    });
    scrollMenu.style.display = 'flex';
}

// Adicionar personagem no time principal
function setPersonagemNoHex(hex, personagem) {
    const playerSlot = hex.parentElement;
    const antigo = selecionados.find(p => p.nome === playerSlot.dataset.nome);
    if (antigo) selecionados = selecionados.filter(p => p !== antigo);

    hex.innerHTML = `<img src="${personagem.img}" alt="${personagem.nome}">`;
    playerSlot.querySelector('.player-info').textContent = `${personagem.nome} - ${personagem.funcao}`;
    playerSlot.dataset.nome = personagem.nome;

    selecionados.push(personagem);
    atualizarSinergias();
}

// Adicionar personagem no banco (com regras)
function setPersonagemNoBanco(hex, personagem) {
    const slotIndex = parseInt(hex.dataset.index);
    const antigo = banco[slotIndex];
    const substituindo = !!antigo;

    if (!substituindo) {
        const countFuncao = banco.filter(p => p && p.funcao === personagem.funcao).length;
        if ((personagem.funcao === "MB" || personagem.funcao === "WS") && countFuncao >= 2) {
            alert(`Máximo de 2 jogadores para a função ${personagem.funcao} no banco.`);
            return;
        }
        if (!(personagem.funcao === "MB" || personagem.funcao === "WS") && countFuncao >= 1) {
            alert(`Máximo de 1 jogador para a função ${personagem.funcao} no banco.`);
            return;
        }
    }

    if (antigo) selecionados = selecionados.filter(p => p !== antigo);

    hex.innerHTML = `<img src="${personagem.img}" alt="${personagem.nome}">`;
    hex.parentElement.querySelector('.player-info').textContent = `${personagem.nome} - ${personagem.funcao}`;
    banco[slotIndex] = personagem;
    selecionados.push(personagem);
    atualizarSinergias();
}

// Atualizar sinergias (escola só titulares, vínculo todos)
function atualizarSinergias() {
    synergyList.innerHTML = "";
    const escolas = new Set();
    const vinculos = new Set();

    const titulares = Array.from(document.querySelectorAll('.hex[data-pos="principal"]'))
        .map(hex => selecionados.find(p => p.nome === hex.parentElement.dataset.nome))
        .filter(Boolean);

    titulares.forEach(p => escolas.add(p.escola));
    selecionados.forEach(p => vinculos.add(p.vinculo));

    if (escolas.size === 0 && vinculos.size === 0) {
        synergyList.innerHTML = "<li>Nenhuma sinergia ativa</li>";
        return;
    }
    escolas.forEach(e => synergyList.innerHTML += `<li>Escola: ${e}</li>`);
    vinculos.forEach(v => synergyList.innerHTML += `<li>Vínculo: ${v}</li>`);
}

// Criar evento para adicionar banco
addBancoBtn.addEventListener('click', () => {
    const novoIndex = banco.length;
    const slot = document.createElement('div');
    slot.classList.add('player-slot');
    slot.innerHTML = `<div class="hex" data-role="S" data-pos="banco" data-index="${novoIndex}"></div><div class="player-info">Banco</div>`;
    bancoContainer.appendChild(slot);

    const hex = slot.querySelector('.hex');
    hex.addEventListener('click', () => {
        const role = hex.getAttribute('data-role');
        mostrarMenu(role, hex, "banco");
    });
});

// Eventos iniciais para titulares
hexes.forEach(hex => {
    hex.addEventListener('click', () => {
        const role = hex.getAttribute('data-role');
        mostrarMenu(role, hex, "principal");
    });
});
</script>

</body>
</html>

